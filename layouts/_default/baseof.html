<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">
{{ partial "head.html" . }}
<body>
    <!-- Site Header -->
    <header class="site-header">
        <div class="container">
            {{ partial "header.html" . }}
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content">
        {{ block "main" . }}{{ end }}
    </main>

    <!-- Site Footer -->
    <footer class="site-footer">
        <div class="container">
            {{ partial "footer.html" . }}
        </div>
    </footer>

    <a class="about-float" href="/about/" aria-label="About">[i]</a>

    <!-- Pass Sanity config to client-side scripts -->
    <script>
        window.SANITY_PROJECT_ID = '{{ .Site.Params.sanityProjectId }}';
        window.SANITY_DATASET = '{{ .Site.Params.sanityDataset }}';
    </script>

    <!-- External Dependencies - Load first without defer -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.28.1/cytoscape.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cytoscape-cose-bilkent@4.1.0/cytoscape-cose-bilkent.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0/dist/fuse.min.js"></script>

    <!-- Hugo Asset Pipeline for JavaScript - Load after dependencies -->
    {{ $sanityClient := resources.Get "js/sanity-client.js" }}
    {{ $graphView := resources.Get "js/graph-view.js" }}
    {{ $openPeeps := resources.Get "js/openpeeps.js" }}
    {{ $js := slice $sanityClient $graphView $openPeeps | resources.Concat "js/bundle.js" | resources.Minify }}
    <script src="{{ $js.Permalink }}" defer></script>
</body>
</html>
