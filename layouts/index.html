{{ define "main" }}
<div class="container">
    <!-- Hero Title -->
    <div class="section">
        <div class="section-head is-first">
            <div class="section-head-main">
                <div class="section-label">Overview</div>
                <h1 class="section-title hero-title">My Second Brain</h1>
                <p class="section-copy">Notes, systems, and references-curated by Mohammad Faisal</p>
            </div>
        </div>
    </div>

    <!-- Search Box -->
    <div class="search-box">
        <input
            type="text"
            class="search-input"
            placeholder="Search notes..."
            id="search-notes"
            aria-label="Search notes"
        >
    </div>

    <!-- Yahoo-style Widgets (only in Yahoo mode) -->
    {{ partial "yahoo-widgets.html" . }}

    {{ $notesData := .Site.Data.sanity.notes }}
    {{ $notes := slice }}
    {{ with $notesData.notes }}
        {{ $notes = . }}
    {{ end }}

    <!-- Category Navigation -->
    <div class="section">
        <div class="section-head">
            <div class="section-head-main">
                <div class="section-label">Categories</div>
                <h2 class="section-title">Explore by Category</h2>
            </div>
        </div>

<div class="notes-grid">
        {{ range $category := slice "Development" "Design" "Learning" "Ideas" }}
        {{ $categoryKey := lower $category }}
        {{ $categoryCount := 0 }}
        {{ range $notes }}
            {{ $noteCategory := lower (default "" .category) }}
            {{ if eq $noteCategory $categoryKey }}
                {{ $categoryCount = add $categoryCount 1 }}
            {{ end }}
        {{ end }}
        <div class="category-card" data-category="{{ $categoryKey }}">
            <div class="category-icon">
                <svg viewBox="0 0 100 100" style="width: 100%; height: 100%;">
                    <circle cx="50" cy="50" r="40" fill="var(--color-teal)" stroke="var(--color-border)" stroke-width="3" />
                    <text x="50" y="60" text-anchor="middle" font-size="40" fill="#45372b" font-weight="700" font-family="Fira Code, JetBrains Mono, Monaco, Consolas, Ubuntu Mono, monospace">{{ substr $category 0 1 }}</text>
                </svg>
            </div>
            <span class="category-label">{{ $category }}</span>
            <span class="category-count">{{ $categoryCount }}</span>
        </div>
        {{ end }}
        </div>
    </div>

    <!-- Recent Notes Section -->
    <div class="section">
        <div class="section-head">
            <div class="section-head-main">
                <div class="section-label">Notes</div>
                <h2 class="section-title">Recent Notes</h2>
            </div>
            {{ if gt (len $notes) 6 }}
            <div class="section-head-cta">
                <a href="/notes/" class="btn btn-primary">View All {{ len $notes }} Notes</a>
            </div>
            {{ end }}
        </div>

<div class="notes-grid" id="recent-notes">
        {{ if $notes }}
            {{ range first 6 $notes }}
                {{ partial "note-card.html" . }}
            {{ end }}
        {{ else }}
            <!-- Empty State -->
            <div class="card-empty-state" style="grid-column: 1 / -1;">
                <div class="card-empty-state-icon">üìù</div>
                <h3>No notes yet!</h3>
                <p>Start creating notes in Sanity Studio to see them here.</p>
                <a href="/studio/" class="btn btn-primary mt-md">Open Sanity Studio</a>
                <p class="empty-signature">Built by <a href="/about/">Mohammad Faisal</a></p>
            </div>
        {{ end }}
        </div>
    </div>

    <!-- Graph View Teaser -->
    <div class="section">
        <div class="section-head">
            <div class="section-head-main">
                <div class="section-label">Mind Map</div>
                <h2 class="section-title">Explore Your Mind Map</h2>
                <p class="section-copy">
                    Visualize the connections between your notes in a force-directed graph.
                    See how ideas cluster and relate to each other.
                </p>
            </div>
            <div class="section-head-cta">
                <a href="/graph/" class="btn btn-secondary">Open Graph View</a>
            </div>
        </div>
    </div>
</div>

<script>
// Client-side stats calculation
document.addEventListener('DOMContentLoaded', function() {
    // This will be enhanced by sanity-client.js to fetch live data
    console.log('Dashboard loaded');
});
</script>
{{ end }}
